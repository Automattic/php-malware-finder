/*
When a new version of WP-CLI is released, you generate hashes for newly-violating files
with something like:
yara -r ./php.yar /path/to/wp-cli-NEWVERSION | sed -e 's/.* //' | xargs sha1sum | uniq

When adding/updating lists, be sure to update ../whitelist.md too!
*/

private rule WPCLI
{
	condition:
		/* 2.5.0: */
		hash.sha1(0, filesize) == "0bd4a1ee50bf6a9871363df294a70528be8d3598" or // php/WP_CLI/Bootstrap/AutoloaderStep.php
		hash.sha1(0, filesize) == "5d02965d8089d86acfba746a8cb286ed99c8da6e" or // php/WP_CLI/Bootstrap/IncludeFallbackAutoloader.php
		hash.sha1(0, filesize) == "e596b90420a87ac7ea7e998e37d375ca0b9a3e20" or // php/WP_CLI/Dispatcher/CommandFactory.php
		hash.sha1(0, filesize) == "d355efd0e3081606eea4d768844e2c8b49f70064" or // php/WP_CLI/Inflector.php
		hash.sha1(0, filesize) == "ba72dafd63af09a137419bcf3461f1494262ef9a" or // php/WP_CLI/Loggers/Execution.php
		hash.sha1(0, filesize) == "a0a88d58f76b81e756ae596e17d2c232d8695ecf" or // php/WP_CLI/Runner.php
		hash.sha1(0, filesize) == "aa0904c9e757a34d3f57518119f8e2d94b37c1b0" or // php/commands/src/Help_Command.php
		hash.sha1(0, filesize) == "cd04a22d73ebf14f1c77704866f95143982af875" or // php/utils.php

		/* 2.6.0: */
		hash.sha1(0, filesize) == "bb14f3240a55390c54d103e9b4d3d5bde12bc0ca" or // php/WP_CLI/Runner.php
		hash.sha1(0, filesize) == "ea8265a1f688dca1f5cd7a87743e4f6198ae0fe4" or // php/utils.php

		/* 2.7.x: */
		hash.sha1(0, filesize) == "6a5249dff601df259a1244bc1f552dabe7300b71" or // php/WP_CLI/Runner.php
		hash.sha1(0, filesize) == "1f36433a9c015ceed7b65594a0777d31bed32404" or // php/utils.php

		/* 2.8.0-alpha: */
		hash.sha1(0, filesize) == "8248ddd70638b6ba55a8c1fa3262294b8ef951e0" or // php/WP_CLI/Runner.php
		hash.sha1(0, filesize) == "4832b9f4aa63e527d023e082923bf18023848835" or // php/utils.php

		false
}
