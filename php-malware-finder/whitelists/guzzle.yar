/*
Guzzle (https://github.com/guzzle/guzzle) is a popular PHP library providing a HTTP client implementation.
It makes use of php://temp and unusually-named variables (e.g. $nano), but is harmless and we'd rather
developers use Guzzle than roll-their-own (assuming that wp_ HTTP methods are unsuitable for them), so we
whitelist Guzzle.

When a new version of Guzzle is released, you generate hashes for newly-violating files with something like:
yara -r ./php.yar /path/to/guzzle-NEWVERSION | sed -e 's/.* //' | xargs sha1sum | uniq

BEFORE GENERATING NEW HASHES, be sure to run composer i --no-dev in the guzzle directory, because guzzle
has sub-dependencies (like psr7) which introduce their own (php://temp) false positives otherwise!

When adding/updating lists, be sure to update ../whitelist.md too!
*/

private rule Guzzle
{
	condition:
		/* Guzzle 6.5.8 */
		hash.sha1(0, filesize) == "22826b712b77c50d85a96a3876e212682056d707" or // Handler/MockHandler.php
		hash.sha1(0, filesize) == "eb5669521a15c4c376fc54b7e90561699bbf7aa5" or // functions.php
		hash.sha1(0, filesize) == "dd228b9beb40785b42daabfc6c13e425eb127893" or // HandlerStack.php
		hash.sha1(0, filesize) == "2c1385b58fb14b73c389fa44fed7a8368cd7be32" or // Handler/StreamHandler.php
		hash.sha1(0, filesize) == "a568713580e06682dbf99dcbadeb2442bad5663c" or // Handler/CurlFactory.php

		/* Guzzle 7.0.0 */
		hash.sha1(0, filesize) == "f669c0c479fb0a7c20a3d862ac262b8ae87442ac" or // Handler/MockHandler.php
		hash.sha1(0, filesize) == "983eb255307afde2115057f99dd2e3d6030f9fec" or // HandlerStack.php
		hash.sha1(0, filesize) == "07bf28a699d50dec06513e53e13d91f68e44f7b7" or // Handler/StreamHandler.php
		hash.sha1(0, filesize) == "7b9daacde2e3713e60d89c5d29fa7e3fd9bcd351" or // Utils.php
		hash.sha1(0, filesize) == "c6b6019202934665058c0cdcacf23874a8eff0ed" or // Handler/CurlFactory.php

		/* Guzzle 7.1.0 */
		hash.sha1(0, filesize) == "d9770bcfcfc99b67f6e7673199f1814b7e285cb5" or // Handler/MockHandler.php
		hash.sha1(0, filesize) == "9b59fd58bb1fe9dc3427f30e82eeaacdb0943b69" or // Utils.php
		hash.sha1(0, filesize) == "5a8aa96d137ab0e9c20094472eb1bc1da4d73556" or // HandlerStack.php
		hash.sha1(0, filesize) == "5eeb1e6930ae01b11a9eccdcb942629adb2d9ee6" or // Handler/CurlFactory.php
		hash.sha1(0, filesize) == "f65e96a98ba8f7d5ae6c701adc5f1318b2a536f7" or // Handler/StreamHandler.php

		/* Guzzle 7.1.1 */
		hash.sha1(0, filesize) == "8e1c5078d5ad9515593f089deda402885a79444c" or // Handler/CurlFactory.php
		hash.sha1(0, filesize) == "ac33174b9f058f724b8eb5f891b213d0b31a9ae4" or // Handler/MockHandler.php
		hash.sha1(0, filesize) == "d3337a10adf0132cc07002d1f9bcdce35b1fef2a" or // Handler/StreamHandler.php

		/* Guzzle 7.2.0 */
		hash.sha1(0, filesize) == "278cb92f31edf6df92616d2db346dea4f37896dc" or // Handler/MockHandler.php
		hash.sha1(0, filesize) == "fca03c8181f84629e2b3f574f0fa6f27ae131ba8" or // Handler/StreamHandler.php
		hash.sha1(0, filesize) == "4d298db54ac0c551025d828e522ada86108c8e41" or // Handler/CurlFactory.php
		hash.sha1(0, filesize) == "f0b9cafd50ea74a23db19d0f1ef353cba949660c" or // Utils.php
		hash.sha1(0, filesize) == "23e657d45588252d391e9dda48f1bb69e6fd0fc5" or // vendor/guzzlehttp/psr7/src/CachingStream.php
		hash.sha1(0, filesize) == "62d77fe44861b2f09b099d4573953666d2177b9d" or // vendor/guzzlehttp/psr7/src/Utils.php

		/* Guzzle 7.3.0 */
		hash.sha1(0, filesize) == "01137ae48d5ecd32aab3580554034123f9bff634" or // Handler/CurlFactory.php
		hash.sha1(0, filesize) == "9bae979882f7a12fe4029f60b3ef32a60b7de0b1" or // Utils.php
		hash.sha1(0, filesize) == "657caf9a0ec92030ee3abbca128fe7a2b892189b" or // Handler/StreamHandler.php
		hash.sha1(0, filesize) == "2f8f9c5c258ffe6adad71e95c4a831e58e9d39d8" or // vendor/guzzlehttp/psr7/src/CachingStream.php
		hash.sha1(0, filesize) == "7d026b5256fddb20cbd1d0820f53393585bdd173" or // vendor/guzzlehttp/psr7/src/Utils.php

		/* Guzzle 7.4.0 */
		hash.sha1(0, filesize) == "8fa95f46c22e77b7f638cdcc0de2d2e43727ca2f" or // vendor/guzzlehttp/psr7/src/Utils.php

		/* Guzzle 7.5.1 */
		hash.sha1(0, filesize) == "c1820ad96327fc4bc73b52f92bbcbd824fda87a0" or // Handler/CurlFactory.php

		/* Guzzle 7.5.2 */
		hash.sha1(0, filesize) == "4dda1d37bfbe7fd6386a6bc7b9f22982a1c277fb" or // Handler/CurlFactory.php
		hash.sha1(0, filesize) == "5ef08935b2a6b0bb77181275b565ffcce15f9bdc" or // Handler/StreamHandler.php

		/* Guzzle 7.6.0 */
		hash.sha1(0, filesize) == "9e2a92abdd1c7ec1577dceb5e891e11191ee93bd" or // Handler/CurlFactory.php
		hash.sha1(0, filesize) == "335f9d8666a5163751edae8b339d820a7141683f" or // Handler/StreamHandler.php

		/* Guzzle 7.7.0 */
		hash.sha1(0, filesize) == "669e3b48569c116ae013068501fa36cafa16be68" or // /Handler/MockHandler.php
		hash.sha1(0, filesize) == "3117da236100e5f02608d1ca7d3603938f55b844" or // /Handler/CurlFactory.php
		hash.sha1(0, filesize) == "a2ee7010131f5ed0c05b9540249a134cd26ca11b" or // /HandlerStack.php
		hash.sha1(0, filesize) == "8d8e4929e4797dd6b167372d7dcec708fc7e82f7" or // /Utils.php
		hash.sha1(0, filesize) == "714f54d183c4066c968fd530ae30b018e31b63c6" or // /Handler/StreamHandler.php

		/* Guzzle < 7.4.0 is compatible with several older (but still safe) versions of PSR7, so we whitelist them separately: */
		/* PSR7 1.7.0: */
		hash.sha1(0, filesize) == "33c19430ff582dbee1a2ed125b68d05b9916d510" or // src/CachingStream.php
		hash.sha1(0, filesize) == "392133877d19bd90a76a61a208f13485823d0f34" or // src/Utils.php

		/* PSR7 1.8.0: */
		hash.sha1(0, filesize) == "5ba04c2124acb1694fd4882eb288af67b6ca3e68" or // src/CachingStream.php
		hash.sha1(0, filesize) == "a7ad421c7bec23b30cdad0ca6fdfb59bfac205e8" or // src/Utils.php

		/* PSR7 1.8.1 - 1.9.x: */
		hash.sha1(0, filesize) == "9fc9f16d55e2d1dab08df073224acc825c4e8b13" or // src/Utils.php

		/* Guzzle 7.4.0 */
		hash.sha1(0, filesize) == "1a1ab72b3aa4bf341e8241d2d61156711c542700" or // Utils.php
		hash.sha1(0, filesize) == "eef71556af334dc04505d7db99be86449d3c9eec" or // Handler/CurlFactory.php
		hash.sha1(0, filesize) == "67be3724995423ee61d41299d1c8eab6ac153fc9" or // Handler/StreamHandler.php
		hash.sha1(0, filesize) == "a2ea7adf581db39f309e72750d6cec5a321281a3" or // HandlerStack.php

		/* Guzzle 7.4.2 */
		hash.sha1(0, filesize) == "fb22fb7d7d9364ebbc3bcbc614998c9da8274c94" or // "Handler/StreamHandler.php

		/* Guzzle 7.5.0 */
		hash.sha1(0, filesize) == "f296c95e0bda52295667b0eba42084fb6c3c4f86" or // Utils.php

		/* Guzzle 7.7.1 */
		hash.sha1(0, filesize) == "bc011ec58482c307f42528146a02b2a97829bf43" or // HandlerStack.php
		hash.sha1(0, filesize) == "079c74b3aceb2d4503718a16eb3033645078d68e" or // Handler/CurlFactory.php

		/* Guzzle 7.8.0 */
		hash.sha1(0, filesize) == "4a638381a4069206f93d07700011c34d2785aee2" or // Handler/CurlFactory.php

		/* Guzzle > 7.5.0 is compatible with PSR7 versions in the 2.x range, so we whitelist them separately: */
		/* PSR7 2.0.0: */
		hash.sha1(0, filesize) == "3d5215560b3b52503daaa850e720c316a0740b3c" or // src/CachingStream.php
		hash.sha1(0, filesize) == "e4188cf754b1cdfe60cbb5ae81742f21aa2bcf56" or // src/Utils.php

		/* PSR7 2.1.0: */
		hash.sha1(0, filesize) == "2e5b277fb486de73618cf4efcf21a0281137723d" or // src/CachingStream.php
		hash.sha1(0, filesize) == "3f3675d0be4f3183d123e486123760089d2bb289" or // src/Utils.php

		/* PSR7 2.2.0 - 2.6.0: */
		hash.sha1(0, filesize) == "f0a3f9ec88e10ed3ec0259a9be0f8cba6ff49a52" or // src/Utils.php

		/* PSR7 2.6.1: */
		hash.sha1(0, filesize) == "b3ab1ccd21afd624505c629da42137a1863fee56" or // src/Utils.php

		false
}
