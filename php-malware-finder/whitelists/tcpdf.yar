/*
TCPDF (https://github.com/tecnickcom/TCPDF, https://tcpdf.org/) provides PHP-based PDF generation. It seems
to be a widely-used and trustworthy piece of open-source software. We incorrectly tag it as containing
"ObfuscatedPhp" because it contains barcode header/metadata in relatively compressed formats, like
\xE2\x80\x93 or long lists of chr(...) calls.

When a new version of TCPDF is released, you generate hashes for newly-violating files with something like:
yara -r ./php.yar /path/to/tcpdf-NEWVERSION | sed -e 's/.* //' | xargs sha1sum | uniq

You'll probably find that only the file tcpdf_barcodes_1d.php routinely changes, and not with every release.
*/

private rule TCPDF
{
	condition:
		/* TCPDF 6.3.5 */
		hash.sha1(0, filesize) == "914fb29209a5da691fcb759af241e66098cc190f" or // tcpdf_barcodes_1d.php

		/* TCPDF 6.4.0 - 6.4.1 */
		hash.sha1(0, filesize) == "52aa12ea4f8c4b76745f4e23438302b57bb77c70" or // tcpdf_barcodes_1d.php

		/* TCPDF 6.4.2 - 6.4.3 */
		hash.sha1(0, filesize) == "c76cea52506beed08793222634122892cd1a6767" or // tcpdf_barcodes_1d.php

		/* TCPDF 6.4.4 - 6.6.1 */
		hash.sha1(0, filesize) == "23c7eac806621bfb7f3f2138b9753ddc387c3bf4" or // tcpdf_barcodes_1d.php

		false
}
