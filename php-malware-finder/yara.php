#!/usr/local/bin/php
<?php
if ( empty( $argv[1] ) ) {
	exit( sprintf( "Usage: %s <file|dir>\n", $argv[0] ) );
}

$command = sprintf( 'yara -w -s -r %s/php.yar %s', __dir__, $argv[1] );

exec( $command, $output );

// Strip these tags, so the output is safe to be printed on the UI.
$output = str_replace( '<?php', '', $output );

print( implode( "\n", $output ) );

exit( ! empty( $output ) ? 1 : 0 );
